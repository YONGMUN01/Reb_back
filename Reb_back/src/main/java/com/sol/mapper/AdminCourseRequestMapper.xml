<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="adminCourseRequest">
	<select id="selectAll" resultType="AdminCourseRequsetListDTO">
	<![CDATA[
		SELECT * FROM (
    		SELECT ROWNUM AS rnum, subquery.* FROM (
        	SELECT  c.COURSE_NUMBER, c.COURSE_TITLE,TO_CHAR(c.COURSE_START_DATE, 'YYYY-MM-DD'),
            TO_CHAR(c.COURSE_END_DATE, 'YYYY-MM-DD'), s.COURSE_STATUS_INFO, t.COURSE_REQUEST_TYPE,
            cr.COURSE_REGISTER_DATE, cr.COURSE_REQUEST_DATE, cr.COURSE_RESULT_DATE, cr.COURSE_REJECT_REASON
        	FROM TBL_COURSE_REQUEST cr
        	JOIN TBL_COURSE c
        	ON cr.COURSE_NUMBER = c.COURSE_NUMBER
        	JOIN TBL_COURSE_OPEN_STATUS s
        	ON cr.COURSE_OPEN_STATUS_NUMBER = s.COURSE_OPEN_STATUS_NUMBER
        	JOIN TBL_COURSE_REQUEST_TYPE t
            ON cr.COURSE_REQUEST_TYPE_NUMBER = t.COURSE_REQUEST_TYPE_NUMBER
        	ORDER BY c.COURSE_START_DATE
    	) subquery
	)
	WHERE rnum BETWEEN #{startRow} AND #{endRow}
		
	]]>
	</select>
	<!-- 보류  -->
	<!-- <select id="getTotal" resultType="int">
		SELECT COUNT(routine_number)
		FROM tbl_routine	
	</select> -->
	<select id="select" parameterType="int" resultType="AdminCourseRequestDTO">
	SELECT 
    cr.COURSE_OPEN_STATUS_NUMBER, cr.COURSE_REQUEST_TYPE_NUMBER,
    TO_CHAR(cr.COURSE_REGISTER_DATE, 'YYYY-MM-DD'), TO_CHAR(cr.COURSE_REQUEST_DATE, 'YYYY-MM-DD'), TO_CHAR(cr.COURSE_RESULT_DATE, 'YYYY-MM-DD'),
    cr.COURSE_REJECT_REASON,
    c.COURSE_NUMBER, c.COURSE_TITLE, c.COURSE_CONTENT,
    c.EXPERT_NUMBER, c.COURSE_RECRUIT_STATUS_NUMBER,
    TO_CHAR(c.COURSE_POST_DATE, 'YYYY-MM-DD'), TO_CHAR(c.COURSE_POST_UPDATE_DATE, 'YYYY-MM-DD'),
    TO_CHAR(c.COURSE_RECRUIT_START_DATE, 'YYYY-MM-DD'), TO_CHAR(c.COURSE_RECRUIT_END_DATE, 'YYYY-MM-DD'),
    TO_CHAR(c.COURSE_START_DATE, 'YYYY-MM-DD'), TO_CHAR(c.COURSE_END_DATE, 'YYYY-MM-DD'),
    TO_CHAR(c.COURSE_START_TIME, 'HH24:MI'), TO_CHAR(c.COURSE_END_TIME, 'HH24:MI'),
    c.COURSE_DAY_OF_WEEK, c.COURSE_RECRUIT_COUNT, c.COURSE_PRICE
	FROM TBL_COURSE_REQUEST cr
	JOIN TBL_COURSE c
    ON cr.COURSE_NUMBER = c.COURSE_NUMBER
	WHERE cr.COURSE_NUMBER = #{courseNumber}

	</select>
</mapper>
